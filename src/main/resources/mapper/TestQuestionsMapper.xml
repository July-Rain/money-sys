<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lawschool.dao.TestQuestionsMapper">
  <resultMap id="BaseResultMap" type="com.lawschool.beans.TestQuestions">
    <result column="ID" jdbcType="VARCHAR" property="id"/>
    <result column="TYPE_ID" jdbcType="VARCHAR" property="typeId"/>
    <result column="COM_CONTENT" jdbcType="VARCHAR" property="comContent"/>
    <result column="QUESTION_DIFFICULTY" jdbcType="VARCHAR" property="questionDifficulty"/>
    <result column="QUESTION_TYPE" jdbcType="VARCHAR" property="questionType"/>
    <result column="ANSWER_CHOICE_NUMBER" jdbcType="DECIMAL" property="answerChoiceNumber"/>
    <result column="ANSWER_ID" jdbcType="VARCHAR" property="answerId"/>
    <result column="SPECIAL_KNOWLEDGE_ID" jdbcType="VARCHAR" property="specialKnowledgeId"/>
    <result column="POLICE_CLASSIFICATION" jdbcType="VARCHAR" property="policeClassification"/>
    <result column="LEGAL_BASIS" jdbcType="VARCHAR" property="legalBasis"/>
    <result column="ANSWER_DESCRIBLE" jdbcType="VARCHAR" property="answerDescrible"/>
    <result column="RELEASE_STATUS" jdbcType="DECIMAL" property="releaseStatus"/>
    <result column="DISABLE_STATUS" jdbcType="DECIMAL" property="disableStatus"/>
    <result column="STU_ISSUER" jdbcType="VARCHAR" property="stuIssuer"/>
    <result column="STU_ISSDEPARTMENT" jdbcType="VARCHAR" property="stuIssdepartment"/>
    <result column="STU_ISSTIM" jdbcType="TIMESTAMP" property="stuIsstim"/>
    <result column="OPTUSER" jdbcType="VARCHAR" property="optuser"/>
    <result column="OPTTIME" jdbcType="TIMESTAMP" property="opttime"/>
    <result column="STU_OPTDEPARTMENT" jdbcType="VARCHAR" property="stuOptdepartment"/>
    <result column="USE_NUMBER" jdbcType="DECIMAL" property="useNumber"/>
    <result column="RIGTH_NUMBER" jdbcType="DECIMAL" property="rigthNumber"/>
    <result column="collectId" property="collectId"/>
  </resultMap>
  <insert id="insert" parameterType="com.lawschool.beans.TestQuestions">
    insert into LAW_TESTQUESTIONS (ID, TYPE_ID, COM_CONTENT,
      QUESTION_DIFFICULTY, QUESTION_TYPE, ANSWER_CHOICE_NUMBER,
      ANSWER_ID, SPECIAL_KNOWLEDGE_ID, POLICE_CLASSIFICATION,
      LEGAL_BASIS, ANSWER_DESCRIBLE, RELEASE_STATUS,
      DISABLE_STATUS, STU_ISSUER, STU_ISSDEPARTMENT,
      STU_ISSTIM, OPTUSER, OPTTIME,
      STU_OPTDEPARTMENT, USE_NUMBER, RIGTH_NUMBER
      )
    values (#{id,jdbcType=VARCHAR}, #{typeId,jdbcType=VARCHAR}, #{comContent,jdbcType=VARCHAR},
      #{questionDifficulty,jdbcType=VARCHAR}, #{questionType,jdbcType=VARCHAR}, #{answerChoiceNumber,jdbcType=DECIMAL},
      #{answerId,jdbcType=VARCHAR}, #{specialKnowledgeId,jdbcType=VARCHAR}, #{policeClassification,jdbcType=VARCHAR},
      #{legalBasis,jdbcType=VARCHAR}, #{answerDescrible,jdbcType=VARCHAR}, #{releaseStatus,jdbcType=DECIMAL},
      #{disableStatus,jdbcType=DECIMAL}, #{stuIssuer,jdbcType=VARCHAR}, #{stuIssdepartment,jdbcType=VARCHAR},
      #{stuIsstim,jdbcType=TIMESTAMP}, #{optuser,jdbcType=VARCHAR}, #{opttime,jdbcType=TIMESTAMP},
      #{stuOptdepartment,jdbcType=VARCHAR}, #{useNumber,jdbcType=DECIMAL}, #{rigthNumber,jdbcType=DECIMAL}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.lawschool.beans.TestQuestions">
    insert into LAW_TESTQUESTIONS
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id != null">
        ID,
      </if>
      <if test="typeId != null">
        TYPE_ID,
      </if>
      <if test="comContent != null">
        COM_CONTENT,
      </if>
      <if test="questionDifficulty != null">
        QUESTION_DIFFICULTY,
      </if>
      <if test="questionType != null">
        QUESTION_TYPE,
      </if>
      <if test="answerChoiceNumber != null">
        ANSWER_CHOICE_NUMBER,
      </if>
      <if test="answerId != null">
        ANSWER_ID,
      </if>
      <if test="specialKnowledgeId != null">
        SPECIAL_KNOWLEDGE_ID,
      </if>
      <if test="policeClassification != null">
        POLICE_CLASSIFICATION,
      </if>
      <if test="legalBasis != null">
        LEGAL_BASIS,
      </if>
      <if test="answerDescrible != null">
        ANSWER_DESCRIBLE,
      </if>
      <if test="releaseStatus != null">
        RELEASE_STATUS,
      </if>
      <if test="disableStatus != null">
        DISABLE_STATUS,
      </if>
      <if test="stuIssuer != null">
        STU_ISSUER,
      </if>
      <if test="stuIssdepartment != null">
        STU_ISSDEPARTMENT,
      </if>
      <if test="stuIsstim != null">
        STU_ISSTIM,
      </if>
      <if test="optuser != null">
        OPTUSER,
      </if>
      <if test="opttime != null">
        OPTTIME,
      </if>
      <if test="stuOptdepartment != null">
        STU_OPTDEPARTMENT,
      </if>
      <if test="useNumber != null">
        USE_NUMBER,
      </if>
      <if test="rigthNumber != null">
        RIGTH_NUMBER,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="id != null">
        #{id,jdbcType=VARCHAR},
      </if>
      <if test="typeId != null">
        #{typeId,jdbcType=VARCHAR},
      </if>
      <if test="comContent != null">
        #{comContent,jdbcType=VARCHAR},
      </if>
      <if test="questionDifficulty != null">
        #{questionDifficulty,jdbcType=VARCHAR},
      </if>
      <if test="questionType != null">
        #{questionType,jdbcType=VARCHAR},
      </if>
      <if test="answerChoiceNumber != null">
        #{answerChoiceNumber,jdbcType=DECIMAL},
      </if>
      <if test="answerId != null">
        #{answerId,jdbcType=VARCHAR},
      </if>
      <if test="specialKnowledgeId != null">
        #{specialKnowledgeId,jdbcType=VARCHAR},
      </if>
      <if test="policeClassification != null">
        #{policeClassification,jdbcType=VARCHAR},
      </if>
      <if test="legalBasis != null">
        #{legalBasis,jdbcType=VARCHAR},
      </if>
      <if test="answerDescrible != null">
        #{answerDescrible,jdbcType=VARCHAR},
      </if>
      <if test="releaseStatus != null">
        #{releaseStatus,jdbcType=DECIMAL},
      </if>
      <if test="disableStatus != null">
        #{disableStatus,jdbcType=DECIMAL},
      </if>
      <if test="stuIssuer != null">
        #{stuIssuer,jdbcType=VARCHAR},
      </if>
      <if test="stuIssdepartment != null">
        #{stuIssdepartment,jdbcType=VARCHAR},
      </if>
      <if test="stuIsstim != null">
        #{stuIsstim,jdbcType=TIMESTAMP},
      </if>
      <if test="optuser != null">
        #{optuser,jdbcType=VARCHAR},
      </if>
      <if test="opttime != null">
        #{opttime,jdbcType=TIMESTAMP},
      </if>
      <if test="stuOptdepartment != null">
        #{stuOptdepartment,jdbcType=VARCHAR},
      </if>
      <if test="useNumber != null">
        #{useNumber,jdbcType=DECIMAL},
      </if>
      <if test="rigthNumber != null">
        #{rigthNumber,jdbcType=DECIMAL},
      </if>
    </trim>
  </insert>


  <!--计数：我收藏的重点试题-->
  <select id="cntMyCollection" parameterType="map" resultType="java.lang.Integer">
    SELECT
    count(LAW_TESTQUESTIONS. ID)
    FROM
    LAW_COLLECTION
    LEFT JOIN LAW_TESTQUESTIONS ON LAW_COLLECTION.COM_STUCODE = LAW_TESTQUESTIONS. ID
    WHERE
    LAW_COLLECTION.COM_USERID = #{userId}
    AND LAW_COLLECTION. TYPE = 20
    And LAW_COLLECTION.DEL_STATUS=0
    <if test="questionType != null">
      AND QUESTION_TYPE=#{questionType}
    </if>
    <if test="typeId != null">
      AND TYPE_ID=#{typeId}
    </if>
    <if test="questionDifficulty != null">
      AND QUESTION_DIFFICULTY=#{questionDifficulty}
    </if>
  </select>

  <!--列表：我收藏的重点试题-->
  <select id="listMyCollection" parameterType="map" resultMap="BaseResultMap">
    SELECT
    LAW_COLLECTION. ID collectId,
    LAW_TESTQUESTIONS. ID,
    LAW_TESTQUESTIONS.COM_CONTENT,
    LAW_TESTQUESTIONS.QUESTION_TYPE,
    LAW_TESTQUESTIONS.ANSWER_ID,
    LAW_TESTQUESTIONS.QUESTION_DIFFICULTY,
    LAW_TESTQUESTIONS.TYPE_ID,
    LAW_TESTQUESTIONS.SPECIAL_KNOWLEDGE_ID,
    ROWNUM AS rowno
    FROM
         LAW_COLLECTION
           LEFT JOIN LAW_TESTQUESTIONS ON LAW_COLLECTION.COM_STUCODE = LAW_TESTQUESTIONS. ID
    WHERE
    LAW_COLLECTION.COM_USERID = #{userId}
    And LAW_COLLECTION.DEL_STATUS=0
    And ROWNUM &lt;= #{endPage}
    AND LAW_COLLECTION. TYPE = 20
    <if test="questionType != null">
      AND QUESTION_TYPE=#{questionType}
    </if>
    <if test="typeId != null">
      AND TYPE_ID=#{typeId}
    </if>
    <if test="questionDifficulty != null">
      AND QUESTION_DIFFICULTY=#{questionDifficulty}
    </if>
    )
    WHERE
    rowno &gt; #{startPage}
  </select>

  <!--列表：我做错的题目-->
  <select id="listMyError" parameterType="map" resultMap="BaseResultMap">

    SELECT
    ID,
    recordId,
    COM_CONTENT,
    QUESTION_TYPE,
    ANSWER_ID,
    QUESTION_DIFFICULTY,
    TYPE_ID,
    SPECIAL_KNOWLEDGE_ID
    from
    (
    SELECT
    T . ID,
    r. ID recordId,
    T .COM_CONTENT,
    T .QUESTION_TYPE,
    T .ANSWER_ID,
    T .QUESTION_DIFFICULTY,
    T .TYPE_ID,
    T .SPECIAL_KNOWLEDGE_ID,
    ROWNUM AS rowno
    FROM
    LAW_USER_QUESTION_RECORD r
    INNER JOIN LAW_TESTQUESTIONS T ON r.QUEST_ID = T . ID
    WHERE
    r.USER_ID = 1
    And ROWNUM &lt;= #{endPage}
    AND r.MY_ASWER_ID != T .ANSWER_ID
    <if test="questionType != null">
      AND T .QUESTION_DIFFICULTY =#{questionType}
    </if>
    <if test="typeId != null">
      AND T .SPECIAL_KNOWLEDGE_ID = #{typeId}
    </if>
    <if test="questionDifficulty != null">
      AND QUESTION_TYPE = #{questionDifficulty}
    </if>
    )
    WHERE
    rowno &gt; #{startPage}
  </select>

  <!--计数：我做错的题目-->
  <select id="cntMyError" parameterType="map" resultType="java.lang.Integer">
    SELECT
      count(T . ID)
    FROM
    LAW_USER_QUESTION_RECORD r
    INNER JOIN LAW_TESTQUESTIONS T ON r.QUEST_ID = T . ID
    WHERE
    r.USER_ID = 1
    AND r.MY_ASWER_ID != T .ANSWER_ID
    <if test="questionType != null">
      AND T .QUESTION_DIFFICULTY =#{questionType}
    </if>
    <if test="typeId != null">
      AND T .SPECIAL_KNOWLEDGE_ID = #{typeId}
    </if>
    <if test="questionDifficulty != null">
      AND QUESTION_TYPE = #{questionDifficulty}
    </if>
  </select>



  <!--查询所有的专项知识试题（模糊查询）-->
  <select id="selectByFuzzy" resultType="com.lawschool.beans.TestQuestions" resultMap="BaseResultMap">
    select
    ID,TYPE_ID,QUESTION_DIFFICULTY,RELEASE_STATUS
    from
    LAW_TESTQUESTIONS
    <where>
      <if test="ID != null">
        and ID = #{id}
      </if>
      <if test="TYPE_ID != null">
        and TYPE_ID = #{typeId}
      </if>
      <if test="QUESTION_DIFFICULTY != null">
        and QUESTION_DIFFICULTY = #{questionDifficulty}
      </if>
      <if test="RELEASE_STATUS != null">
        and RELEASE_STATUS = #{releaseStatus}
      </if>
    </where>
  </select>

  <!-- 查询专项知识试题-->
  <select id="selectById" parameterType="java.lang.String" resultType="com.lawschool.beans.TestQuestions">
        select *
        from
        LAW_TESTQUESTIONS
        where
        ID = #{id}
    </select>
  <!-- 编辑试题-->
  <update id=" update" parameterType="com.lawschool.beans.TestQuestions">
        update
        LAW_TESTQUESTIONS
        set
        <set>
          <if test="TYPE_ID ! = null">
            TYPE_ID = #{typeId, jdbcType=VARCHAR},
          </if>
          <if test="COM_CONTENT ! = null">
            COM_CONTENT = #{comContent, jdbcType=VARCHAR},
          </if>
          <if test="QUESTION_DIFFICULTY ! = null">
            QUESTION_DIFFICULTY = #{questionDifficulty,jdbcType=VARCHAR},
          </if>
          <if test="QUESTION_TYPE ! = null">
            QUESTION_TYPE = #{questionType,jdbcType=VARCHAR},
          </if>
          <if test="ANSWER_CHOICE_NUMBER ! = null">
            ANSWER_CHOICE_NUMBER = #{answerChoiceNumber,jdbcType=DECIMAL},
          </if>
          <if test="ANSWER_ID ! = null">
            ANSWER_ID = #{answerId,jdbcType=VARCHAR},
          </if>
          <if test="SPECIAL_KNOWLEDGE_ID ! = null">
            SPECIAL_KNOWLEDGE_ID = #{specialKnowledgeId,jdbcType=VARCHAR},
          </if>
          <if test="POLICE_CLASSIFICATION ! = null">
            POLICE_CLASSIFICATION = #{policeClassification,jdbcType=VARCHAR},
          </if>
          <if test="LEGAL_BASIS ! = null">
            LEGAL_BASIS = #{legalBasis,jdbcType=VARCHAR},
          </if>
          <if test="ANSWER_DESCRIBLE ! = null">
            ANSWER_DESCRIBLE = #{answerDescrible,jdbcType=VARCHAR},
          </if>
          <if test="RELEASE_STATUS ! = null">
            RELEASE_STATUS = #{releaseStatus,jdbcType=DECIMAL},
          </if>
          <if test="DISABLE_STATUS ! = null">
            DISABLE_STATUS = #{disableStatus,jdbcType=DECIMAL},
          </if>
          <if test="STU_ISSUER ! = null">
            STU_ISSUER = #{stuIssuer,jdbcType=VARCHAR},
          </if>
          <if test="STU_ISSDEPARTMENT ! = null">
            STU_ISSDEPARTMENT = #{stuIssdepartment,jdbcType=VARCHAR},
          </if>
          <if test="STU_ISSTIM ! = null">
            STU_ISSTIM = #{stuIsstim,jdbcType=TIMESTAMP},
          </if>
          <if test="OPTUSER ! = null">
            OPTUSER = #{optuser,jdbcType=VARCHAR},
          </if>
          <if test="OPTTIME ! = null">
            OPTTIME = #{opttime,jdbcType=TIMESTAMP},
          </if>
          <if test="STU_OPTDEPARTMENT ! = null">
            STU_OPTDEPARTMENT = #{stuOptdepartment,jdbcType=VARCHAR},
          </if>
          <if test="USE_NUMBER ! = null">
            USE_NUMBER = #{useNumber,jdbcType=DECIMAL},
          </if>
          <if test="RIGTH_NUMBER ! = null">
            RIGTH_NUMBER = #{rigthNumber,jdbcType=DECIMAL},
          </if>
        </set>
        where
       ID = #{id,jdbcType=VARCHAR}
    </update>
  <!-- 启用禁用-->
  <update id="updateStatus" parameterType="com.lawschool.beans.TestQuestions">
        update
        LAW_TESTQUESTIONS
        set
        RELEASE_STATUS=#{testQuestions.releaseStatus}
        where
        t.ID=#{testQuestions.id}
    </update>
  <!--  删除专项知识试题-->
  <delete id="deleteById" parameterType="java.lang.String">
        delete
        from
        LAW_TESTQUESTIONS
        WHERE
        ID = #{id}
    </delete>
  <!--  批量导入试题-->
  <insert id="insertTestQuestions" parameterType="com.lawschool.beans.TestQuestions">
      insert into
       LAW_TESTQUESTIONS
       (ID, TYPE_ID, COM_CONTENT,
      QUESTION_DIFFICULTY, QUESTION_TYPE, ANSWER_CHOICE_NUMBER,
      ANSWER_ID, SPECIAL_KNOWLEDGE_ID, POLICE_CLASSIFICATION,
      LEGAL_BASIS, ANSWER_DESCRIBLE, RELEASE_STATUS,
      DISABLE_STATUS, STU_ISSUER, STU_ISSDEPARTMENT,
      STU_ISSTIM, OPTUSER, OPTTIME,
      STU_OPTDEPARTMENT, USE_NUMBER, RIGTH_NUMBER)
       values
       (#{id,jdbcType=VARCHAR}, #{typeId,jdbcType=VARCHAR}, #{comContent,jdbcType=VARCHAR},
      #{questionDifficulty,jdbcType=VARCHAR}, #{questionType,jdbcType=VARCHAR}, #{answerChoiceNumber,jdbcType=DECIMAL},
      #{answerId,jdbcType=VARCHAR}, #{specialKnowledgeId,jdbcType=VARCHAR}, #{policeClassification,jdbcType=VARCHAR},
      #{legalBasis,jdbcType=VARCHAR}, #{answerDescrible,jdbcType=VARCHAR}, #{releaseStatus,jdbcType=DECIMAL},
      #{disableStatus,jdbcType=DECIMAL}, #{stuIssuer,jdbcType=VARCHAR}, #{stuIssdepartment,jdbcType=VARCHAR},
      #{stuIsstim,jdbcType=TIMESTAMP}, #{optuser,jdbcType=VARCHAR}, #{opttime,jdbcType=TIMESTAMP},
      #{stuOptdepartment,jdbcType=VARCHAR}, #{useNumber,jdbcType=DECIMAL}, #{rigthNumber,jdbcType=DECIMAL}
      )
  </insert>
  <!--  批量导入后查所有-->
  <select id="selectParent" resultType="com.lawschool.beans.TestQuestions">
        select id,comContent from  LAW_TESTQUESTIONS
    </select>
  <!--树形-->
  <select id="selectAllTestQuestions" resultType="com.lawschool.beans.TestQuestions">
        select * from LAW_TESTQUESTIONS
    </select>
</mapper>